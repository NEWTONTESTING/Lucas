<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mauritius Sign Language - Quiz</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <style>
  df-messenger {
    --df-messenger-button-titlebar-color: #ffffff;  /* White button */
    --df-messenger-button-titlebar-font-color: #000000; /* Black text/icon inside */
  }
</style>

</head>
<body class="d-flex flex-column min-vh-100">

  <!-- Navbar (styled like alphabet.html) -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid d-flex justify-content-between">
      <!-- Brand -->
      <a class="navbar-brand" href="index.html" style="font-family: 'Avenir LT Std 95 Black', sans-serif;">
        Mauritius Sign Language
      </a>
      <!-- Toggler -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <!-- Nav links -->
      <div class="collapse navbar-collapse d-flex justify-content-end" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" href="alphabet.html" style="font-family: 'Avenir LT Std 95 Black', sans-serif;">Alphabet</a></li>
          <li class="nav-item"><a class="nav-link active" href="quiz.html" style="font-family: 'Avenir LT Std 95 Black', sans-serif;">Quiz</a></li>
          <li class="nav-item"><a class="nav-link" href="translator.html" style="font-family: 'Avenir LT Std 95 Black', sans-serif;">Practice</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <main class="flex-fill">


<!-- Quiz Menu -->
<section class="py-5" id="quizMenu">
  <div class="container">
    <h2 class="section-title" style="color: rgb(0, 47, 108);">Alphabet Quiz</h2>
    <div class="card-container">
      <div class="card">
        <h5>Alphabet Quiz</h5>
        <p>Test your knowledge of the MSL alphabet with 20 interactive questions.</p>
        <button class="btn btn-primary" onclick="startQuiz('alphabet')">Start Alphabet Quiz</button>
      </div>
    </div>
  </div>
</section>


    <!-- Alphabet Quiz -->
    <section class="py-5" id="alphabetQuiz" style="display:none;">
      <div class="container">
        <h2 class="section-title">Alphabet Quiz</h2>
        <div class="card">
          <div class="card-body" id="quizContent">
            <h5 id="questionTitle">Question 1</h5>
            <p id="questionText">Loading question...</p>
            
<img id="questionImage" src="" alt="" class="sign-image" style="display:none;">

<div class="text-center mt-3">
  <input type="text" id="textAnswer" placeholder="Type the letter (A-Z)" 
         class="form-control mb-2" style="display:none; max-width:200px; margin:0 auto;">
  
  <video id="webcam" autoplay width="640" height="480" class="sign-image" style="display:none;"></video>
  <p id="recognizedLetter" style="display:none;">Recognized Letter: None</p>
  <button id="startRecognition" onclick="startRecognition()" 
          class="btn btn-secondary mb-2" style="display:none;">Start Recognition</button>

  <!-- âœ… Single aligned submit button -->
  <button id="submitAnswer" onclick="submitAnswer()" class="btn btn-primary mt-2">Submit Answer</button>
</div>

            <p id="feedback"></p>
            <img id="correctImage" alt="Correct sign" style="display:none; max-width:200px; margin-top:10px;">
            <p id="score">Score: 0/20</p>
            <button id="nextQuestion" onclick="nextQuestion()" class="btn btn-primary" style="display:none;">Next Question</button>
            <button id="backToSelection" onclick="backToSelection()" class="btn btn-secondary">Back</button>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- Footer -->
  <footer class="mt-auto">
    <div class="container">
      <p>&copy; 2025 Mauritius Sign Language. All rights reserved.</p>
    </div>
  </footer>

  <!-- Quiz Logic -->
  
<script>
  const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
  let currentQuestion = 0;
  let score = 0;
  let questions = [];
  let isCameraQuestion = false;

  // Function to decide whether to load .png or .gif
  function getImagePath(letter) {
    const gifLetters = ['J', 'P', 'S', 'Y', 'Z']; // letters with gifs
    if (gifLetters.includes(letter)) {
      return `images/quiz/Hand_${letter}.gif`;
    } else {
      return `images/quiz/Hand_${letter}.png`;
    }
  }

  function generateQuestions() {
    const q = [];
    for (let i = 0; i < 10; i++) {
      q.push({ type: 'text', letter: letters[Math.floor(Math.random() * 26)] });
      q.push({ type: 'camera', letter: letters[Math.floor(Math.random() * 26)] });
    }
    return q.sort(() => Math.random() - 0.5);
  }

  function startQuiz(section) {
    if (section === 'alphabet') {
      document.getElementById('quizMenu').style.display = 'none';
      document.getElementById('alphabetQuiz').style.display = 'block';
      questions = generateQuestions();
      currentQuestion = 0;
      score = 0;
      document.getElementById('score').textContent = 'Score: 0/20';
      loadQuestion();
    }
  }

  function loadQuestion() {
    const q = questions[currentQuestion];
    isCameraQuestion = q.type === 'camera';
    document.getElementById('feedback').textContent = '';
    document.getElementById('correctImage').style.display = 'none';

    document.getElementById('questionTitle').textContent = `Question ${currentQuestion + 1}`;
    document.getElementById('questionText').textContent = isCameraQuestion ? 
      `Replicate the sign for ${q.letter}` : `What letter does this sign represent?`;

    if (!isCameraQuestion) {
      document.getElementById('questionImage').src = getImagePath(q.letter);
      document.getElementById('questionImage').style.display = 'block';
    } else {
      document.getElementById('questionImage').style.display = 'none';
    }

    document.getElementById('textAnswer').style.display = isCameraQuestion ? 'none' : 'block';
    document.getElementById('webcam').style.display = isCameraQuestion ? 'block' : 'none';
    document.getElementById('recognizedLetter').style.display = isCameraQuestion ? 'block' : 'none';
    document.getElementById('startRecognition').style.display = isCameraQuestion ? 'block' : 'none';
  }

  function submitAnswer() {
    const q = questions[currentQuestion];
    let userAnswer = '';
    if (isCameraQuestion) {
      userAnswer = document.getElementById('recognizedLetter').textContent.replace('Recognized Letter: ', '');
    } else {
      userAnswer = document.getElementById('textAnswer').value.toUpperCase();
    }

    if (userAnswer === q.letter) {
      score++;
      } else {
  if (isCameraQuestion) {
    document.getElementById('feedback').textContent = 'Incorrect';
    document.getElementById('correctImage').src = getImagePath(q.letter);
    document.getElementById('correctImage').style.display = 'block';
  } else {
    document.getElementById('feedback').textContent = `Incorrect. Correct is ${q.letter}`;
  }
}

    document.getElementById('score').textContent = `Score: ${score}/20`;
    document.getElementById('nextQuestion').style.display = 'block';
  }

  function nextQuestion() {
    currentQuestion++;
    if (currentQuestion < questions.length) {
      document.getElementById('feedback').textContent = '';
            document.getElementById('nextQuestion').style.display = 'none';
      loadQuestion();
    } else {
      document.getElementById('feedback').textContent = 'Quiz completed!';
            document.getElementById('nextQuestion').style.display = 'none';
    }
  }
</script>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Dialogflow Messenger -->
  <script src="https://www.gstatic.com/dialogflow-console/fast/messenger/bootstrap.js?v=1"></script>
<df-messenger
  intent="WELCOME"
  chat-title="SASbot"
  agent-id="9a2fc8cb-3d01-49b5-ad52-ad5cb66c8023"
  language-code="en"
  chat-icon="images/logo.png">
</df-messenger>

<script>
  // Preload quiz images (both PNG + GIF)
  const quizLetters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
  const gifLetters = ['J', 'P', 'S', 'Y', 'Z'];

  quizLetters.forEach(letter => {
    const img = new Image();
    if (gifLetters.includes(letter)) {
      img.src = `images/quiz/Hand_${letter}.gif`;
    } else {
      img.src = `images/quiz/Hand_${letter}.png`;
    }
  });
</script>

</body>
</html>
